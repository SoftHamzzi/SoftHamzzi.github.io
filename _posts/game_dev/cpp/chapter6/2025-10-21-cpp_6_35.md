---
title:  "[C++] ν•­λ© 35: κ°€μƒ ν•¨μ λ€μ‹  μ“Έ κ²ƒλ“¤λ„ μƒκ°ν•΄ λ‘λ” μμ„Έλ¥Ό μ‹μ‹λ•λ•λ΅ κΈΈλ¬ λ‘μ"
excerpt: "ν•­λ© 35"

categories:
  - Cpp
tags:
  - [Cpp]

toc: true
toc_sticky: true
 
date: 2025-10-21
last_modified_at: 2025-10-21
---
μ΄ κΈ€μ€ μ•„λμ μ±…μ„ μμ„Έν μ •λ¦¬ν• ν›„, μ •λ¦¬ν• κΈ€μ„ GPTμ—κ² μ”μ•½μ„ μ”μ²­ν•μ—¬ μ‘μ„±λμ—μµλ‹λ‹¤.  
μ΄ν™ν‹°λΈ C++ μ 3ν, μ¤μ½§ λ§μ΄μ–΄μ¤ μ €μ, κ³½μ©μ¬ λ²μ—­
{: .notice--warning}

# π“¦ 6. μƒμ†, κ·Έλ¦¬κ³  κ°μ²΄ μ§€ν–¥ μ„¤κ³„
## π‘‰π» ν•­λ© 35: κ°€μƒ ν•¨μ λ€μ‹  μ“Έ κ²ƒλ“¤λ„ μƒκ°ν•΄ λ‘λ” μμ„Έλ¥Ό μ‹μ‹λ•λ•λ΅ κΈΈλ¬ λ‘μ

### β… κΈ°λ³Έμ μΈ κ°€μƒ ν•¨μ μ ‘κ·Όλ²•

κ²μ„ μΊλ¦­ν„°μ μ²΄λ ¥μ„ κ³„μ‚°ν•λ” ν•¨μλ¥Ό λ‹¤μκ³Ό κ°™μ΄ κµ¬ν„ν•  μ μλ‹¤:

```cpp
class GameCharacter {
public:
    // μΊλ¦­ν„°μ μ²΄λ ¥μ„ λ°ν™ν•λ” λ‹¨μ κ°€μƒ ν•¨μ
    virtual int healthValue() const;
    ...
};

// μ²΄λ ¥μ„ κ³„μ‚°ν•λ” κΈ°λ³Έ μ•κ³ λ¦¬μ¦ μ κ³µ
int GameCharacter::healthValue() const { ... }
```

ν•μ§€λ§ κ°€μƒ ν•¨μκ°€ ν•­μƒ μµμ„ μ μ„ νƒμ€ μ•„λ‹λ‹¤. μƒν™©μ— λ”°λΌ λ” λ‚μ€ λ€μ•λ“¤μ΄ μλ‹¤.

---

### β… λ°©λ²• 1: λΉ„κ°€μƒ μΈν„°νμ΄μ¤(NVI) κ΄€μ©κµ¬λ¥Ό ν†µν• ν…ν”λ¦Ώ λ©”μ„λ“ ν¨ν„΄

```cpp
class GameCharacter {
public:
    // μΌλ° ν•¨μμ΄λ―€λ΅ μ¬μ •μ λ¶κ°€
    int healthValue() const {
        ... // μ‚¬μ „ λ™μ‘ μν–‰
        int retVal = doHealthValue(); // μ‹¤μ  λ™μ‘ μν–‰
        ... // μ‚¬ν›„ λ™μ‘ μν–‰
        return retVal;
    }
    ...

private:
    // κ°€μƒ ν•¨μμ΄λ―€λ΅, νμƒ ν΄λμ¤λ” μ¬μ •μ κ°€λ¥
    // μ²΄λ ¥μ„ κ³„μ‚°ν•λ” κΈ°λ³Έ μ•κ³ λ¦¬μ¦ μ κ³µ
    virtual int doHealthValue() const { ... }
};
```

**ν•µμ‹¬ μ•„μ΄λ””μ–΄:**

- `healthValue()`λ” μ΄μ  **μΌλ° ν•¨μ**μ΄λ‹¤.
- private κ°€μƒ ν•¨μμΈ `doHealthValue()`κ°€ κ°„μ ‘μ μΌλ΅ νΈμ¶λλ‹¤.
- μ΄λ¥Ό **λΉ„κ°€μƒ ν•¨μ μΈν„°νμ΄μ¤(NVI) κ΄€μ©κµ¬**λΌκ³  λ¶€λ¥΄λ©°, **ν…ν”λ¦Ώ λ©”μ„λ“ λ””μμΈ ν¨ν„΄**μ ν• ν•νƒμ΄λ‹¤.

**μ¥μ :**

- `healthValue()`λ” κ°€μƒ ν•¨μ `doHealthValue()`μ **λ©νΌ(wrapper)** μ—­ν• μ„ ν•λ‹¤.
- μ‚¬μ „/μ‚¬ν›„ λ™μ‘μ„ ν†µν•΄ `doHealthValue()`κ°€ μ•μ „ν•κ² μ‹¤ν–‰λλ‹¤.
    - μ: **λ®¤ν…μ¤ μ κΈ**, **λ΅κ·Έ μ •λ³΄ κΈ°λ΅**, **ν΄λμ¤μ λ¶λ³€μ†μ„± κ²€μ¦**, **ν•¨μμ μ‚¬μ „/μ‚¬ν›„ μ΅°κ±΄ ν™•μΈ** λ“±

**μ„¤κ³„ νΉμ§•:**

- `doHealthValue()`λ” νμƒ ν΄λμ¤μ—μ„ **μ¬μ •μλ” κ°€λ¥**ν•μ§€λ§, **μ§μ ‘ νΈμ¶μ€ λ¶κ°€λ¥**ν•λ‹¤.
- ν•¨μλ¥Ό **μ–Έμ  νΈμ¶ν•λ”μ§€**λ” κΈ°λ³Έ ν΄λμ¤μ κ¶ν•μ΄λ‹¤.
- λ°λ“μ‹ privateμΌ ν•„μ”λ” μ—†λ‹¤:
    - protected λ©¤λ²„μ—¬μ•Ό ν•  κ²½μ°λ„ μκ³  (ν•­λ© 27μ Window::onResize())
    - public λ©¤λ²„μ—¬μ•Ό ν•  κ²½μ°λ„ μλ‹¤ (ν•­λ© 7μ λ‹¤ν•μ„± κΈ°λ³Έ ν΄λμ¤μ μ†λ©Έμ)

---

### β… λ°©λ²• 2: ν•¨μ ν¬μΈν„°λ΅ κµ¬ν„ν• μ „λµ ν¨ν„΄

```cpp
class GameCharacter;

// μ²΄λ ¥μ„ κ³„μ‚°ν•λ” κΈ°λ³Έ μ•κ³ λ¦¬μ¦
int defaultHealthCalc(const GameCharacter& gc);

class GameCharacter {
public:
    // ν•¨μ ν¬μΈν„°
    // HealthCalcFunc == int (*)(const GameCharacter&);
    typedef int (*HealthCalcFunc)(const GameCharacter&);

    // λ¬µμ‹μ  ν•λ³€ν™ λ¶κ°€ν• μƒμ„±μ
    explicit GameCharacter(HealthCalcFunc hcf = defaultHealthCalc)
    : healthFunc(hcf) {}

    int healthValue() const { return healthFunc(*this); }
    ...

private:
    HealthCalcFunc healthFunc;
};

class EvilBadGuy : public GameCharacter {
public:
    explicit EvilBadGuy(HealthCalcFunc hcf = defaultHealthCalc)
    : GameCharacter(hcf) { ... }
    ...
};

// λ‹¤λ¥Έ λ™μ‘μ„ ν•λ” μ²΄λ ¥ κ³„μ‚° ν•¨μλ“¤
int loseHealthQuickly(const GameCharacter&);
int loseHealthSlowly(const GameCharacter&);

int main() {
    // κ°™μ€ νƒ€μ…μ΄μ§€λ§, μ²΄λ ¥ κ³„μ‚°μ΄ λ‹¤λ¥΄κ² λ¨
    EvilBadGuy ebg1(loseHealthQuickly);
    EvilBadGuy ebg2(loseHealthSlowly);
}
```

**μ¥μ :**

- **μ „λµ ν¨ν„΄**μ„ μ‚¬μ©ν•μ—¬ μ²΄λ ¥ κ³„μ‚° λ΅μ§μ„ λ¶„λ¦¬ν–λ‹¤.
- κ° κ°μ²΄λ§λ‹¤ **λ‹¤λ¥Έ μ²΄λ ¥ κ³„μ‚° ν•¨μ**λ¥Ό κ°€μ§ μ μλ‹¤.
- κ²μ„ μ‹¤ν–‰ λ„μ¤‘, **μ²΄λ ¥ κ³„μ‚° ν•¨μλ¥Ό λ™μ μΌλ΅ λ³€κ²½**ν•  μ μλ‹¤.

**λ‹¨μ :**

- μ²΄λ ¥ κ³„μ‚° ν•¨μ λ‚΄μ—μ„ `GameCharacter` κ³„ν†µ κ°μ²΄μ **public λ©¤λ²„κ°€ μ•„λ‹ λ°μ΄ν„°μ— μ ‘κ·Όν•  μ μ—†λ‹¤**.
- μ ‘κ·Ό κ°€λ¥ν•κ² ν•λ ¤λ©΄ ν΄λμ¤μ **μΊ΅μν™”λ¥Ό μ•½ν™”**μ‹μΌμ•Ό ν•λ‹¤.

---

### β… λ°©λ²• 3: functionμΌλ΅ κµ¬ν„ν• μ „λµ ν¨ν„΄

ν•¨μ ν¬μΈν„° λ€μ‹  **ν•¨μ κ°μ²΄**λ¥Ό μ‚¬μ©ν•λ” λ°©λ²•μ΄λ‹¤.

```cpp
class GameCharacter;
int defaultHealthCalc(const GameCharacter& gc);

class GameCharacter {
public:
    // ν•¨μνΈμ¶μ„± κ°μ²΄
    // GameCharacterμ™€ νΈν™λλ” λ¨λ“  κ²ƒμ„ λ°›μ„ μ μκ³ ,
    // intμ™€ νΈν™λλ” λ¨λ“  νƒ€μ…μ κ°μ²΄λ¥Ό λ°ν™ν•λ‹¤
    typedef function<int (const GameCharacter&)> HealthCalcFunc;

    explicit GameCharacter(HealthCalcFunc hcf = defaultHealthCalc)
    : healthFunc(hcf) {}

    int healthValue() const { return healthFunc(*this); }
    ...

private:
    HealthCalcFunc healthFunc;
};
```

**ν•µμ‹¬:**

- `function<int (const GameCharacter&)>`λ” `int (*)(const GameCharacter&)`μ™€ λΉ„μ·ν•μ§€λ§, λ” κ°•λ ¥ν•λ‹¤.
- **λ€μƒ μ‹κ·Έλ‹μ²μ™€ νΈν™λλ”** ν•¨μνΈμ¶μ„± κ°μ²΄λ¥Ό μ–΄λ–¤ κ²ƒμ΄λ“  κ°€μ§ μ μλ‹¤.
    - **νΈν™λλ‹¤**: μ‹κ·Έλ‹μ²μ™€ λ™μΌν• νƒ€μ…μ΄κ±°λ‚, ν•΄λ‹Ή νƒ€μ…μΌλ΅ **μ•”μ‹μ  λ³€ν™μ΄ κ°€λ¥ν• νƒ€μ…**

**λ‹¤μ–‘ν• μ‚¬μ© μμ‹:**

```cpp
// λ°ν™ νƒ€μ…μ΄ intκ°€ μ•„λ‹ shortμΈ ν•¨μλ„ νΈν™λ¨!
short calcHealth(const GameCharacter&);

// ν•¨μ κ°μ²΄
struct HealthCalculator {
    int operator()(const GameCharacter&) const { ... }
};

class GameLevel {
public:
    // λ°ν™ νƒ€μ…μ΄ intκ°€ μ•„λ‹ floatμΈ λ©¤λ²„ ν•¨μλ„ νΈν™λ¨!
    float health(const GameCharacter&) const;
    ...
};

class EvilBadGuy : public GameCharacter { ... };
class EyeCandyCharacter : public GameCharacter { ... };

int main() {
    // μΌλ° ν•¨μ ν¬μΈν„° μ‚¬μ©
    EvilBadGuy ebg1(calcHealth);

    // ν•¨μ κ°μ²΄ μ‚¬μ©
    EyeCandyCharacter ecc1(HealthCalculator());

    GameLevel currentLevel;
    ...
    // λ©¤λ²„ ν•¨μ ν¬μΈν„° μ‚¬μ© (bindλ΅ κ°μ‹Έμ•Ό ν•¨)
    EvilBadGuy ebg2(
        bind(&GameLevel::health, currentLevel, _1)
    );
}
```

**functionμ΄ λ°›μ„ μ μλ” κ²ƒλ“¤:**

- μΌλ° ν•¨μ ν¬μΈν„°: `int (*)(const GameCharacter&)`
- λλ‹¤: `[](const GameCharacter&) { ... }`
- ν•¨μ κ°μ²΄: `struct Foo { int operator()(const GameCharacter&) const; };`
- λ©¤λ²„ ν•¨μ ν¬μΈν„°: `std::bind`λ΅ κ°μ‹Έμ„ μ‚¬μ©

**bind μ‚¬μ©λ²•:**

```cpp
EvilBadGuy ebg2(bind(&GameLevel::health, currentLevel, _1));
```

- `&GameLevel::health` β†’ λ©¤λ²„ ν•¨μ ν¬μΈν„°
- `currentLevel` β†’ μ–΄λ–¤ GameLevel κ°μ²΄λ¥Ό μ“Έμ§€ μ§€μ •
- `_1` β†’ ν”λ μ΄μ¤ν™€λ”λ΅μ„, EvilBadGuyμ μ²΄λ ¥ κ³„μ‚° ν•¨μ νΈμ¶ μ‹ μ „λ‹¬λ  GameCharacter μλ¦¬

---

### β… λ°©λ²• 4: "κ³ μ „μ μΈ" μ „λµ ν¨ν„΄

```cpp
class GameCharacter;

class HealthCalcFunc {
public:
    ...
    virtual int calc(const GameCharacter& gc) const { ... }
    ...
};

HealthCalcFunc defaultHealthCalc;

class GameCharacter {
public:
    explicit GameCharacter(HealthCalcFunc *phcf = &defaultHealthCalc)
    : pHealthCalc(phcf)
    {}

    int healthValue() const { return pHealthCalc->calc(*this); }
    ...

private:
    HealthCalcFunc* pHealthCalc;
};
```

**νΉμ§•:**

- `HealthCalcFunc` ν΄λμ¤ κ³„ν†µμ„ **ν™•μ¥μ— μ—΄λ ¤μλ„λ΅** λ§λ“¤μ–΄λ‘μ—λ‹¤.
- μ „λµ ν¨ν„΄μ **μ „ν†µμ μΈ κµ¬ν„ ν•νƒ**μ΄λ‹¤.

**ν΄λμ¤ κµ¬μ΅°:**

```
GameCharacter κ³„ν†µ   <- (Has-a)   HealthCalcFunc κ³„ν†µ
β”β”€β”€ EvilBadGuy                    β”β”€β”€ SlowHealthLoser
β””β”€β”€ EyeCandyCharacter             β””β”€β”€ FastHealthLoser
```

- GameCharacterλ” HealthCalcFunc κ°μ²΄λ¥Ό **ν¬ν•¨(Composition)** ν•λ‹¤.
- ν•μ½ ν΄λμ¤ κ³„ν†µμ— μ†ν•΄ μλ” κ°€μƒ ν•¨μλ¥Ό λ‹¤λ¥Έ μ½ κ³„ν†µμ— μλ” κ°€μƒ ν•¨μλ΅ λ€μ²΄ν• ν•νƒμ΄λ‹¤.

---

### β… λ„¤ κ°€μ§€ λ°©λ²• μ”μ•½

1. **λΉ„κ°€μƒ μΈν„°νμ΄μ¤(NVI) κ΄€μ©κµ¬ μ‚¬μ©**
    - private μμ—­μ— μλ” κ°€μƒ ν•¨μλ¥Ό μΌλ° public λ©¤λ²„ ν•¨μλ΅ κ°μ‹Έμ„ νΈμ¶ν•λ‹¤.
    - ν…ν”λ¦Ώ λ©”μ„λ“ ν¨ν„΄μ ν• ν•νƒμ΄λ‹¤.
2. **κ°€μƒ ν•¨μλ¥Ό ν•¨μ ν¬μΈν„° λ°μ΄ν„° λ©¤λ²„λ΅ λ€μ²΄**
    - μ „λµ ν¨ν„΄μ ν•µμ‹¬μ΄λ‹¤.
3. **κ°€μƒ ν•¨μλ¥Ό function λ°μ΄ν„° λ©¤λ²„λ΅ λ€μ²΄**
    - νΈν™λλ” μ‹κ·Έλ‹μ²λ¥Ό κ°€μ§„ ν•¨μνΈμ¶μ„± κ°μ²΄λ¥Ό μ‚¬μ©ν•  μ μλ„λ΅ ν•λ‹¤.
    - μ „λµ ν¨ν„΄μ ν• ν•νƒμ΄λ‹¤.
4. **ν•μ½ ν΄λμ¤ κ³„ν†µμ— μ†ν•΄ μλ” κ°€μƒ ν•¨μλ¥Ό λ‹¤λ¥Έ μ½ κ³„ν†µμ— μλ” κ°€μƒ ν•¨μλ΅ λ€μ²΄**
    - μ „λµ ν¨ν„΄μ μ „ν†µμ μΈ κµ¬ν„ ν•νƒμ΄λ‹¤.

---

### π§ μ •λ¦¬

1. κ°€μƒ ν•¨μ λ€μ‹ μ— μ“Έ μ μλ” λ‹¤λ¥Έ λ°©λ²•μΌλ΅ **NVI κ΄€μ©κµ¬** λ° **μ „λµ ν¨ν„΄**μ΄ μλ‹¤.  
μ΄ μ¤‘ NVI κ΄€μ©κµ¬λ” **ν…ν”λ¦Ώ λ©”μ„λ“ ν¨ν„΄**μ ν• μμ΄λ‹¤.
2. κ°μ²΄μ— ν•„μ”ν• κΈ°λ¥μ„ λ©¤λ²„ ν•¨μμ—μ„ ν΄λμ¤ μ™Έλ¶€μ λΉ„λ©¤λ²„ ν•¨μλ΅ μ®κΈ°λ©΄,  
κ·Έ ν΄λμ¤μ **public λ©¤λ²„κ°€ μ•„λ‹ κ²ƒλ“¤μ„ μ ‘κ·Όν•  μ μ—†μ–΄μ§„λ‹¤**.
3. **function κ°μ²΄**λ” μΌλ°ν™”λ ν•¨μ ν¬μΈν„°μ²λΌ λ™μ‘ν•λ‹¤.  
μ΄ κ°μ²΄λ” μ£Όμ–΄μ§„ λ€μƒ μ‹κ·Έλ‹μ²μ™€ **νΈν™λλ” λ¨λ“  ν•¨μνΈμ¶μ„± κ°μ²΄λ¥Ό μ§€μ›**ν•λ‹¤.